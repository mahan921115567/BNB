
<div class="flex flex-col space-y-6">
  <div class="flex items-center justify-between flex-wrap gap-4">
    <h2 class="text-2xl font-bold text-amber-500 dark:text-amber-400">بازار ارزهای دیجیتال</h2>
    
    <!-- Sort Buttons -->
    <div class="flex bg-gray-100 dark:bg-gray-800/60 backdrop-blur-md rounded-2xl p-1 border border-gray-200 dark:border-gray-700/50">
      <button 
        (click)="setSort('default')" 
        [class.bg-amber-400/20]="sortOrder() === 'default'" 
        [class.dark:bg-amber-400/10]="sortOrder() === 'default'" 
        [class.text-amber-600]="sortOrder() === 'default'"
        [class.dark:text-amber-400]="sortOrder() === 'default'"
        class="px-3 py-1.5 rounded-xl text-xs sm:text-sm font-medium transition-all text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white">
        همه
      </button>
      <button 
        (click)="setSort('gainers')" 
        [class.bg-green-500/20]="sortOrder() === 'gainers'" 
        [class.text-green-600]="sortOrder() === 'gainers'"
        [class.dark:text-green-400]="sortOrder() === 'gainers'"
        class="px-3 py-1.5 rounded-xl text-xs sm:text-sm font-medium transition-all text-gray-600 dark:text-gray-300 hover:text-green-600 dark:hover:text-green-400 mx-1">
        بیشترین رشد
      </button>
      <button 
        (click)="setSort('losers')" 
        [class.bg-red-500/20]="sortOrder() === 'losers'" 
        [class.text-red-600]="sortOrder() === 'losers'"
        [class.dark:text-red-400]="sortOrder() === 'losers'"
        class="px-3 py-1.5 rounded-xl text-xs sm:text-sm font-medium transition-all text-gray-600 dark:text-gray-300 hover:text-red-600 dark:hover:text-red-400">
        بیشترین افت
      </button>
    </div>
  </div>

  <!-- Search Input -->
  <div class="relative w-full">
    <input 
      type="text" 
      [(ngModel)]="searchTerm"
      placeholder="جستجوی نام یا نماد ارز..."
      class="w-full p-3 pl-10 bg-gray-100 dark:bg-gray-800/60 border border-gray-200 dark:border-gray-700/50 rounded-2xl text-gray-900 dark:text-white focus:ring-2 focus:ring-amber-400 focus:border-amber-400 outline-none transition-all">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
  </div>
  
  <div class="space-y-4">
    @if (enrichedCryptos().length === 0) {
      <div class="text-center py-12 text-gray-500 bg-gray-100 dark:bg-gray-800/30 rounded-3xl border border-gray-200 dark:border-white/5">
        <p>ارز دیجیتال مورد نظر یافت نشد.</p>
      </div>
    } @else {
      @for (crypto of enrichedCryptos(); track crypto.id) {
        <div class="group bg-white/50 dark:bg-gray-900/50 backdrop-blur-xl border border-gray-200 dark:border-gray-800 p-4 rounded-3xl flex items-center justify-between transition-all duration-300 hover:bg-gray-100/60 dark:hover:bg-gray-800/60 hover:border-gray-300 dark:hover:border-gray-700 hover:scale-[1.01] hover:shadow-xl shadow-lg gap-4">
          <!-- Crypto Info -->
          <div class="flex items-center space-x-4 space-x-reverse min-w-[140px]">
            <div class="w-12 h-12 flex items-center justify-center bg-black/5 dark:bg-black/20 rounded-2xl shadow-inner border border-black/5 dark:border-white/5" [innerHTML]="crypto.sanitizedLogo"></div>
            <div>
              <p class="font-bold text-lg text-gray-900 dark:text-white tracking-wide">{{ crypto.name }}</p>
              <div class="flex items-center gap-2">
                 <p class="text-sm font-bold text-gray-600 dark:text-gray-400 bg-black/5 dark:bg-black/20 px-2 py-0.5 rounded-lg">{{ crypto.symbol }}</p>
              </div>
            </div>
          </div>
          
          <!-- Chart (Hidden on very small screens) -->
          <div class="hidden sm:block flex-grow max-w-[150px] opacity-70 group-hover:opacity-100 transition-opacity">
             <app-price-chart [cryptoId]="crypto.id"></app-price-chart>
          </div>

          <!-- Price & Change -->
          <div class="text-left flex flex-col items-end">
            <p class="font-bold font-mono text-lg text-gray-900 dark:text-white tracking-tight">{{ crypto.price | number:'1.0-0' }} <span class="text-xs text-gray-500 font-sans">تومان</span></p>
            
            <div class="flex items-center gap-1 mt-1 px-2 py-1 rounded-lg text-xs font-bold"
                 [class.bg-green-500/10]="(crypto.change24h || 0) >= 0"
                 [class.text-green-600]="(crypto.change24h || 0) >= 0"
                 [class.dark:text-green-400]="(crypto.change24h || 0) >= 0"
                 [class.bg-red-500/10]="(crypto.change24h || 0) < 0"
                 [class.text-red-600]="(crypto.change24h || 0) < 0"
                 [class.dark:text-red-400]="(crypto.change24h || 0) < 0">
              @if ((crypto.change24h || 0) >= 0) {
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd" /></svg>
              } @else {
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12 13a1 1 0 110 2h5a1 1 0 011 1v-5a1 1 0 11-2 0v2.586l-4.293-4.293a1 1 0 01-1.414 0L8 9.586 3.707 5.293a1 1 0 01-1.414 1.414l5 5a1 1 0 011.414 0L11 9.414 14.586 13H12z" clip-rule="evenodd" /></svg>
              }
              <span>{{ (crypto.change24h || 0) | number:'1.2-2' }}%</span>
            </div>
          </div>
        </div>
      }
    }
  </div>
</div>
